<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" src="js/jquery-3.2.0.min.js" ></script>
    <script type="text/javascript" src="js/jquery.cookie.js"></script>
    <link rel="stylesheet" href="css/layui.css">
    <script type="text/javascript" src="js/layui.js"></script>
    <script>

        function getCommentsByKeyword(data) {
            var keyword=data.value;

            $.ajax({
                url:"getComment/"+encodeURI(encodeURI(keyword)),
                type:"get",
                dataType:"json",
                success:function(data)
                {

                    alert(data.length);
                    for(var j=0; j<data.length;j++)
                    {
                        var str='<button  value="'+data[j].keyName+'"  onclick="getCommentsByKeyword();"  class="layui-btn layui-btn-primary layui-btn-sm" >'+data[j].ctext+'</button>';

                        $("#comments").append(str);
                    }


                }

            });

        }

        $(function(){
            $("#addComment").click(function(){

                //1. 创建一个formdata对象
                var formData = new FormData(document.getElementById("myform"));

                $.ajax({
                    url:"addComment",
                    type:"post",
                    data:formData,
                    dataType:"json",
                    contentType:false,
                    processData:false,
                    cache:false,
                    success:function(data)
                    {

                        //{result:true}
                        if(data.result)
                        {
                            alert("添加成功");
                        }
                        else
                        {
                            alert("添加失败");
                        }
                    }
                });

            });



            function load() {


                $.ajax({
                    url:"getKeyword",
                    type:"get",
                    dataType:"json",
                    success:function(data)
                    {


                        for(var j=0; j<data.length;j++)
                        {
                          var str='<button onclick="getCommentsByKeyword(this);" value="'+data[j].keyName+'"  onclick="getCommentsByKeyword();"  class="layui-btn layui-btn-primary layui-btn-sm" >'+data[j].keyName+'</button>';

                            $("#block0").append(str);
                        }


                    }

                });




            }

            load()


        })


    </script>
</head>
<body>

<form id="myform">
    请输入评价<input id="Comment" name="ctext" type="text" value="">
    <button id="addComment">添加</button>
</form>

<div id="block0">

</div>

<div id="comments">

</div>

</body>
</html>