<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>分类管理</title>
    <link rel="stylesheet" href="css/layui.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="js/layui.js"></script>
    <script src="js/Convert_Pinyin.js"></script>
    <script>
        $(function () {
            function load(type) {
                $.ajax({
                    url: "showClassify/"+type,
                    type: "post",
                    dataType: "json",
                    contentType: false,
                    processData: false,
                    cache: false,
                    success: function (data) {
                        $("#mytable").empty();
                        for (var i = 0; i < data.length; i++) {

                            var str =  '<tr>'+
                                '<td><input name="chks" type="checkbox" value="'+data[i].classifyID+'" style="margin-left: -10px;margin-top: 8px"> 3</td>'+
                                '<td>'+data[i].className+'</td>' +
                                '<td>'+data[i].classDis+'</td>'+
                                '<td>' +
                                '<a style="text-decoration:none" href="modifyClassify.html?cid="'+data[i].classifyID+' class="layui-btn layui-btn-warm layui-btn-sm">修改</a>' +
                                '</td>'+
                                '</tr>';
                            $("#mytable").append(str);
                        }
                    }
                });
            }

            load(0);



            $("#sortID").click(function() {
              load(1)
            });

            $("#sortName").click(function() {
                $.ajax({
                    url: "showClassify/2",
                    type: "post",
                    dataType: "json",
                    contentType: false,
                    processData: false,
                    cache: false,
                    success: function (data) {

                        var headChar='';



                        $("#mytable").empty();
                        for (var i = 0; i < data.length; i++) {

                            if(headChar!=(pinyin.getFullChars(data[i].className)).substr(0,1)){
                                headChar=(pinyin.getFullChars(data[i].className)).substr(0,1);
                                var title='  <tr>'+
                                   ' <td>'+headChar+'</td>'+
                                    '<td></td>'+
                                    '<td></td>'+
                                    '<td></td>'+
                                    '</tr>';
                                $("#mytable").append(title);
                            }

                            var str = '<tr>' +
                                '<td><input name="chks" type="checkbox" value="' + data[i].classifyID + '" style="margin-left: -10px;margin-top: 8px"> 3</td>' +
                                '<td>' + data[i].className + '</td>' +
                                '<td>' + data[i].classDis + '</td>' +
                                '<td>' +
                                '<a style="text-decoration:none" href="modifyClassify.html?cid="'+data[i].classifyID+' class="layui-btn layui-btn-warm layui-btn-sm">修改</a>' +
                                '</td>' +
                                '</tr>';
                            $("#mytable").append(str);
                        }
                    }
                });
            });

            $("#deleteClassify").click(function() {

                var ids ='';

                $.each($('input:checkbox:checked'),function(){
                    ids+=$(this).val()+",";

                });



                $.ajax({
                    url: "deleteClassify/"+ids.substr(0,ids.length-1),
                    type: "get",
                    dataType: "json",
                    contentType: false,
                    processData: false,
                    cache: false,
                    success: function () {
                       alert("删除成功")
                        load();
                    }
                });



            });

            $("#findClassify").click(function() {

                var content =$("#content").val();




                $.ajax({
                    url: "findClassify/"+content,
                    type: "get",
                    dataType: "json",
                    contentType: false,
                    processData: false,
                    cache: false,
                    success: function (data) {
                        $("#mytable").empty();
                        for (var i = 0; i < data.length; i++) {


                            var str = '<tr>' +
                                '<td><input name="chks" type="checkbox" value="' + data[i].classifyID + '" style="margin-left: -10px;margin-top: 8px"> 3</td>' +
                                '<td>' + data[i].className + '</td>' +
                                '<td>' + data[i].classDis + '</td>' +
                                '<td>' +
                                '<a style="text-decoration:none" href="modifyClassify.html?cid="'+data[i].classifyID+' class="layui-btn layui-btn-warm layui-btn-sm">修改</a>' +
                                '</td>' +
                                '</tr>';
                            $("#mytable").append(str);
                        }
                    }
                });



            });




        });
    </script>
</head>
<body style="background-color: #f2f2f2" marginheight="0">
<div class="layui-col-md8" style="margin-top: 30px">
    <table  class="layui-table" lay-skin="line" lay-size="lg">
        <colgroup>
            <col width="150">
            <col width="200">
            <col>
        </colgroup>
        <thead>
        <tr style="background-color: #dddddd">
            <th>分类id
                <button id="sortID">排序️</button>
            </th>
            <th>分类名
                <button id="sortName">排序️</button>
            </th>
            <th>
                <input id="content" type="text" style="width: 150px;height: 25px">
                <button id="findClassify" class="layui-btn layui-btn-normal layui-btn-xs" style="height: 29px;width: 50px">搜索</button>
            </th>
            <th>
                <button id="deleteClassify" class="layui-btn layui-btn-danger layui-btn-sm" style="float: right;margin-right: 25px;">删除
                </button>
            </th>

        </tr>
        </thead>
        <tbody id="mytable">

        <tr>
            <td>A</td>
            <td></td>
            <td></td>
            <td></td>
        </tr>

        <tr>
            <td><input value="1" name="chks" type="checkbox" style="margin-left: -10px;margin-top: 8px"> 3</td>
            <td>古典风格</td>
            <td></td>
            <td>
                <a style="text-decoration:none" href="modifyClassify.html?cid=1" class="layui-btn layui-btn-warm layui-btn-sm">修改</a>
            </td>
        </tr>


        <tr>
            <td><input value="2" name="chks" type="checkbox" style="margin-left: -10px;margin-top: 8px"> 3</td>
            <td>古典风格</td>
            <td></td>
            <td>
                <a style="text-decoration:none" href="modifyClassify.html?cid=1" class="layui-btn layui-btn-warm layui-btn-sm">修改</a>
            </td>
        </tr>

        <tr>
            <td><input value="3" name="chks" type="checkbox" style="margin-left: -10px;margin-top: 8px"> 3</td>
            <td>古典风格</td>
            <td></td>
            <td>
                <a style="text-decoration:none" href="modifyClassify.html?cid=1" class="layui-btn layui-btn-warm layui-btn-sm">修改</a>
            </td>
        </tr>


        </tbody>
    </table>


</div>


</body>
</html>